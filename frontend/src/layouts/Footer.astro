---
import FooterIcons from '@/components/ui/footer-icons.astro';
import Container from './Container.astro';

interface FooterSection {
  title: string;
  links: {
    title: string;
    path: string;
    children?: {
      title?: string;
      path?: string;
    }[];
  }[];
}

const { footer, socialMedia, companyName } = Astro.props;
---

<footer
  class='bg-footer-background text-accent'
  aria-labelledby='footer-heading'
>
  <Container class='py-4 lg:py-8'>
    <h2 id='footer-heading' class='sr-only'>Footer</h2>

    <div class='xl:grid xl:grid-cols-1 xl:gap-8'>
      <div
        class='mt-16 md:grid md:grid-cols-2 lg:grid-cols-4 md:gap-8 xl:col-span-2 xl:mt-0'
      >
        {
          footer.section.map((section: FooterSection) => (
            <div>
              <h3 class='font-heading text-xl text-footer-text mb-2'>
                {section.title}
              </h3>
              <ul role='list' class='mb-6'>
                {section.links.map((link) => (
                  <li class='pt-2'>
                    {/* Render only the children if they exist */}
                    {(link.children ?? []).length > 0 ? (
                      <ul>
                        {(link.children ?? []).map((childLink) => (
                          <li class='pt-2'>
                            <a
                              href={childLink.path}
                              class='lg:text-base transition-all text-footer-text hover:text-accent'
                            >
                              {childLink.title}
                            </a>
                          </li>
                        ))}
                      </ul>
                    ) : (
                      // Otherwise, render the parent link
                      <a
                        href={link.path}
                        class='lg:text-base transition-all text-footer-text hover:text-accent'
                      >
                        {link.title}
                      </a>
                    )}
                  </li>
                ))}
              </ul>
            </div>
          ))
        }
      </div>
    </div>
  </Container>

  <Container class='md:flex md:items-center md:justify-between py-4 lg:py-8'>
    <FooterIcons socials={socialMedia} />

    <p class='mt-4 text-sm text-footer-text md:order-1 md:mt-0'>
      &copy; {new Date().getFullYear()}
      {companyName} All rights reserved.
    </p>
  </Container>
</footer>
