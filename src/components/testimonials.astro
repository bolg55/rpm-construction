---
import { featuredTestimonial, testimonials } from '@/data/testimonialData';

function cn(...classes: string[]) {
  return classes.filter(Boolean).join(' ');
}
---

<div
  class='mx-auto mt-16 grid max-w-4xl grid-cols-1 grid-rows-1 gap-8 text-sm leading-6 text-primary sm:mt-20 sm:grid-cols-2 xl:mx-0 xl:max-w-none xl:grid-flow-col xl:grid-cols-4'
>
  <figure
    class='hover:scale-105 ease-linear hover:cursor-auto transition-all duration-200 rounded-2xl bg-white shadow-lg ring-1 ring-primary/5 sm:col-span-2 xl:col-start-2 xl:row-end-1'
  >
    <blockquote
      class='p-6 text-lg font-semibold leading-7 tracking-tight text-primary sm:p-12 sm:text-xl sm:leading-8'
    >
      <p>{`“${featuredTestimonial.body}”`}</p>
    </blockquote>
    <figcaption
      class='flex flex-wrap items-center gap-x-4 gap-y-4 border-t border-primary/10 px-6 py-4 sm:flex-nowrap'
    >
      <div class='flex-auto'>
        <div class='font-semibold'>- {featuredTestimonial.author.name}</div>
      </div>
    </figcaption>
  </figure>

  {
    testimonials.map((columnGroup, columnGroupIdx) => (
      <div class='space-y-8 xl:contents xl:space-y-0'>
        {columnGroup.map((column, columnIdx) => (
          <div
            class={cn(
              (columnGroupIdx === 0 && columnIdx === 0) ||
                (columnGroupIdx === testimonials.length - 1 &&
                  columnIdx === columnGroup.length - 1)
                ? 'xl:row-span-2'
                : 'xl:row-start-1',
              'space-y-8'
            )}
          >
            {column.map((testimonial) => (
              <figure class='rounded-2xl bg-white hover:scale-105 ease-linear hover:cursor-auto transition-all duration-200 p-6 shadow-lg ring-1 ring-primary/5'>
                <blockquote class='text-primary'>
                  <p>{`“${testimonial.body}”`}</p>
                </blockquote>
                <figcaption class='mt-6 flex items-center gap-x-4'>
                  <div>
                    <div class='font-semibold'>- {testimonial.author.name}</div>
                  </div>
                </figcaption>
              </figure>
            ))}
          </div>
        ))}
      </div>
    ))
  }
</div>
